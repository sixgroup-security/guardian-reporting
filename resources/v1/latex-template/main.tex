%%
% Copyright (c) 2017 - 2021, Pascal Wagler;
% Copyright (c) 2014 - 2021, John MacFarlane
%
% All rights reserved.
%
% Redistribution and use in source and binary forms, with or without
% modification, are permitted provided that the following conditions
% are met:
%
% - Redistributions of source code must retain the above copyright
% notice, this list of conditions and the following disclaimer.
%
% - Redistributions in binary form must reproduce the above copyright
% notice, this list of conditions and the following disclaimer in the
% documentation and/or other materials provided with the distribution.
%
% - Neither the name of John MacFarlane nor the names of other
% contributors may be used to endorse or promote products derived
% from this software without specific prior written permission.
%
% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
% "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
% LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
% FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
% COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
% INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
% BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
% LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
% CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
% LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
% ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
% POSSIBILITY OF SUCH DAMAGE.
%%

%%
% This is the Eisvogel pandoc LaTeX template.
%
% For usage information and examples visit the official GitHub page:
% https://github.com/Wandmalfarbe/pandoc-latex-template
%%

% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names,table}{xcolor}
%
\documentclass[english,paper=a4,captions=tableheading]{scrartcl}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{setspace}
%\setstretch{1.2}
\usepackage{iftex}
% \usepackage[sfdefault]{noto}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\definecolor{default-linkcolor}{HTML}{A50000}
\definecolor{default-filecolor}{HTML}{A50000}
\definecolor{default-citecolor}{HTML}{4077C0}
\definecolor{default-urlcolor}{HTML}{4077C0}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\urlstyle{same} % disable monospaced font for URLs
% https://de.overleaf.com/learn/latex/Page_size_and_margins
\usepackage[margin=1.5cm,hoffset=0ex,includehead=true,includefoot=true,centering,]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\},fontsize=\small}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}

% Workaround/bugfix from jannick0.
% See https://github.com/jgm/pandoc/issues/4302#issuecomment-360669013)
% or https://github.com/Wandmalfarbe/pandoc-latex-template/issues/2
%
% Redefine the verbatim environment 'Highlighting' to break long lines (with
% the help of fvextra). Redefinition is necessary because it is unlikely that
% pandoc includes fvextra in the default template.
% \usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{fontsize=\tiny,commandchars=\\\{\}}

% add backlinks to footnote references, cf. https://tex.stackexchange.com/questions/302266/make-footnote-clickable-both-ways
\usepackage{footnotebackref}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
%\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage[main=english]{babel}
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

%
% for the background color of the title page
%
\usepackage{pagecolor}
\usepackage{afterpage}
% https://de.overleaf.com/learn/latex/Page_size_and_margins
\usepackage[margin=1.5cm,hoffset=0ex,includehead=true,includefoot=true,centering]{geometry}

%
% break urls
%
\PassOptionsToPackage{hyphens}{url}

%
% When using babel or polyglossia with biblatex, loading csquotes is recommended
% to ensure that quoted texts are typeset according to the rules of your main language.
%
\usepackage{csquotes}

%
% captions
%
\definecolor{caption-color}{HTML}{000000}
\usepackage[textfont={color=caption-color}, position=top, skip=4mm, font=small, labelfont=bf, singlelinecheck=false, justification=raggedright]{caption}
\setcapindent{0em}
% Distance between tables
\captionsetup[table]{position=bottom, skip=0pt}
\captionsetup[figure]{position=bottom, skip=1pt}

%
% blockquote
%
\definecolor{blockquote-border}{RGB}{221,221,221}
\definecolor{blockquote-text}{RGB}{119,119,119}
\usepackage{mdframed}
\newmdenv[rightline=false,bottomline=false,topline=false,linewidth=3pt,linecolor=blockquote-border,skipabove=\parskip]{customblockquote}
\renewenvironment{quote}{\begin{customblockquote}\list{}{\rightmargin=0em\leftmargin=0em}%
\item\relax\color{blockquote-text}\ignorespaces}{\unskip\unskip\endlist\end{customblockquote}}

%
% Source Sans Pro as the de­fault font fam­ily
% Source Code Pro for monospace text
%
% 'default' option sets the default
% font family to Source Sans Pro, not \sfdefault.
%
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
    \usepackage[default]{sourcesanspro}
  \usepackage{sourcecodepro}
  \else % if not pdftex
    \usepackage[default]{sourcesanspro}
  \usepackage{sourcecodepro}

  % XeLaTeX specific adjustments for straight quotes: https://tex.stackexchange.com/a/354887
  % This issue is already fixed (see https://github.com/silkeh/latex-sourcecodepro/pull/5) but the
  % fix is still unreleased.
  % TODO: Remove this workaround when the new version of sourcecodepro is released on CTAN.
  \ifxetex
    \makeatletter
    \defaultfontfeatures[\ttfamily]
      { Numbers   = \sourcecodepro@figurestyle,
        Scale     = \SourceCodePro@scale,
        Extension = .otf }
    \setmonofont
      [ UprightFont    = *-\sourcecodepro@regstyle,
        ItalicFont     = *-\sourcecodepro@regstyle It,
        BoldFont       = *-\sourcecodepro@boldstyle,
        BoldItalicFont = *-\sourcecodepro@boldstyle It ]
      {SourceCodePro}
    \makeatother
  \fi
  \fi

%
% heading color
%
\definecolor{heading-color}{RGB}{40,40,40}
\addtokomafont{section}{\color{heading-color}}
% When using the classes report, scrreprt, book,
% scrbook or memoir, uncomment the following line.
%\addtokomafont{chapter}{\color{heading-color}}

%
% variables for title, author and date
%
\usepackage{titling}
\title{Vinaque sanguine metuenti cuiquam Alcyone fixus}
\author{Author Name}
\date{2017-02-20}

%
% tables
%


%
% remove paragraph indention
%
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines

%
%
% Listings
%
%


%%
%% Guardian
%%
\usepackage{lastpage}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage{tikz} % Required to draw things
\usepackage{booktabs,siunitx} % Required for Pandoc
\usepackage{pgfplots}
% Make sure that images converted from Markdown are scalled correctly.
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to H (requires the float package)
\usepackage{float}
\makeatletter
\def\fps@figure{H}
\makeatother

% This invalidates the Latex command \centering 
\def\centering{\relax}
% Required for tables that span several pages.
\usepackage{longtable}
\setlength\LTleft{0pt}
\setlength\LTright{0pt}
% Required to ensure href text performs line breaks
\usepackage{soul}
\usepackage{array}
\usepackage{calc}

% Import project information
\RequirePackage{guardian}

% Required in combination with Pandoc argument --listings
% https://en.wikibooks.org/wiki/LaTeX/Source_Code_Listings
\usepackage{listings}
\newcommand{\passthrough}[1]{#1}
\lstset{
	basicstyle=\footnotesize\ttfamily,
	breaklines=true,
	captionpos=b,
	tabsize=4,
%	numberstyle=\scriptsize,
	xleftmargin=4.5ex,
	escapeinside={(\#}{\#)},
%	numbers=left
}

% Required to perform report version comparison
\usepackage{xparse}
\ExplSyntaxOn
\NewDocumentCommand{\fpcompare}{mmm}
 {
  \fp_compare:nTF { #1 } { #2 } { #3 }
 }
\ExplSyntaxOff


% Perform table adjustments
%\AtBeginEnvironment{tabular*}{\rowcolors{1}{\ifnumless{\rownum}{2}{tableheader_color}{white}}{}}
\renewcommand{\arraystretch}{1.2} % Increase space between rows
\AtBeginEnvironment{tabularx}{\small}
\AtBeginEnvironment{tabular}{\small\renewcommand{\arraystretch}{1.2}}
\AtBeginEnvironment{tabular*}{\small\renewcommand{\arraystretch}{1.2}}
\AtBeginEnvironment{longtable}{\small\renewcommand{\arraystretch}{1.2}}


% Customize bullet lists
\usepackage{enumitem}
\setlist[itemize]{label=\rule[0.5ex]{0.6ex}{0.6ex}, align=parleft, leftmargin=13pt, labelsep=-10pt}
\setlist[enumerate]{label=\rule[0.5ex]{0.6ex}{0.6ex}, align=parleft, leftmargin=13pt, labelsep=-10pt}

% Define spacing before and after section headers
\RedeclareSectionCommand[beforeskip=3pt,afterskip=1pt]{section}
\RedeclareSectionCommand[beforeskip=3pt,afterskip=1pt]{subsection}
\RedeclareSectionCommand[beforeskip=3pt,afterskip=1pt]{subsubsection}

% header and footer
\usepackage[]{scrlayer-scrpage}

\newpairofpagestyles{guardian-header-footer}{
  \clearpairofpagestyles
  \ihead*{\footnotesize \projectname \\[-1ex] \reportstatus{} Report}
  \chead*{}
  \ohead*{\footnotesize \providername\\[-1ex]Version \reportversion}
  \ifoot*{\footnotesize \classification}
  \cfoot*{}
  \ofoot*{\footnotesize \thepage/\pageref{LastPage}}
  \addtokomafont{pageheadfoot}{\upshape}
}
\pagestyle{guardian-header-footer}

% set PDF properties
\hypersetup{
  pdftitle={\reportstatus Report - \projectname},
  pdfauthor={\providername (\providershort)},
  pdflang={en},
  pdfsubject={Markdown},
  hidelinks,
  colorlinks=false,
  breaklinks=true,
  pdfcreator={Guardian}}

% Define labeltext command used by vulnerabilityheader command (see next)
\newcounter{mylabelcounter}
\makeatletter
\newcommand{\labeltext}[2]{%
#1\refstepcounter{mylabelcounter}%
\immediate\write\@auxout{%
  \string\newlabel{#2}{{1}{\thepage}{{\unexpanded{#1}}}{mylabelcounter.\number\value{mylabelcounter}}{}}%
}%
}
\makeatother

% generic vulnerability header
\setcounter{secnumdepth}{4}
\newcommand{\vulnerabilityheader}[6]{
  \setcounter{tocdepth}{5}
  \addcontentsline{toc}{paragraph}{#6 - #3}
  \setcounter{tocdepth}{\mytocdepth}
  \labeltext{
	  \renewcommand*{\arraystretch}{2}
	  \begin{tabularx}{\textwidth}{m{.4cm} m{1.91cm} m{14cm} m{0.01pt}}\hline
	  \rowcolor{#1}
	  \multicolumn{2}{l}{\textcolor{white}{\textbf{\large \labeltext{#6}{#5}}}} & \textcolor{white}{\textbf{\large #3}} & \\\hline
	  \begin{tikzpicture}
		\draw[rounded corners, fill=#1,#1] (0, 0) rectangle (0.5, 0.5) {};
	  \end{tikzpicture} & #2 & #4 & \\\hline
	  \end{tabularx}
  }{header:#5}
}

% Define vulnerability headers for critical, high, medium or low vulnerabilities.
\newcommand{\criticalheader}[4]{\vulnerabilityheader{criticalcolor}{Critical}{#1}{#2}{#3}{#4}}
\newcommand{\highheader}[4]{\vulnerabilityheader{highcolor}{High}{#1}{#2}{#3}{#4}}
\newcommand{\mediumheader}[4]{\vulnerabilityheader{mediumcolor}{Medium}{#1}{#2}{#3}{#4}}
\newcommand{\lowheader}[4]{\vulnerabilityheader{lowcolor}{Low}{#1}{#2}{#3}{#4}}
\newcommand{\infoheader}[4]{\vulnerabilityheader{infocolor}{Info}{#1}{#2}{#3}{#4}}
\newcommand{\closedheader}[4]{\vulnerabilityheader{infocolor}{Closed}{#1}{#2}{#3}{#4}}

% CVSS Table
\newcommand{\cvssheader}[3]{
	\renewcommand*{\arraystretch}{1.6}
	\begin{tabularx}{\textwidth}{m{2cm} m{4cm} m{14cm} m{0.01pt}}\hline
	\textbf{Base Score} & \textbf{Qual. Severity Rating} & \textbf{Vector String} \\\hline
	#1 & #2 & #3\\\hline
	\end{tabularx}
}

% We want all links to be underlined. The reporting engine will replace all \href{ by \slink{.
\newcommand{\slink}[2]{\href{#1}{\ul{#2}}}

%%
%% End Guardian
%%



\begin{document}
\input{report.tex}
\end{document}
